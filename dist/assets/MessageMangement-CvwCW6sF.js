import{r as o,M as f,h as u,j as a,S as g,f as w,o as x,W as N,X as C}from"./index-irexueTV.js";import{A as j}from"./AdminLayout-Bi5iCY7q.js";import{R as A}from"./RenderAttachment-CQ0cw_Za.js";import{T as b}from"./Table-BTKQXWHi.js";import{a as M,B as S}from"./Menu-CmgIRgBM.js";import{A as v}from"./Avatar-Cp4DZ0XV.js";import"./IconButton-DwQ1NlaF.js";import"./Modal-CTaQcr3u.js";import"./Typography-JwG0Pq1m.js";import"./ExitToApp-5YtZ6gSP.js";import"./Container-B0pkiVXL.js";import"./TextField-BOKVHMeR.js";import"./isMuiElement-Bv43l1N-.js";import"./Menu-Bt0IaSNa.js";import"./Tooltip-CVusUE4k.js";import"./Toolbar-CXjODSla.js";import"./MenuItem-DnPP-E3C.js";import"./Button-yxfB9dJ-.js";import"./InputAdornment-BnHJggO_.js";import"./CircularProgress-BdQMOYhd.js";const E=[{field:"id",headerName:"ID",headerClassName:"table-header",width:200},{field:"attachments",headerName:"Attachments",headerClassName:"table-header",width:200,renderCell:t=>{const{attachments:s}=t.row;return(s==null?void 0:s.length)>0?s.map(n=>{const m=n.url,r=w(m);return a.jsx(S,{children:a.jsx("a",{href:m,download:!0,target:"_blank",style:{color:"black"},children:A(r,m)})})}):"No attachments"}},{field:"sender",headerName:"Sent By",headerClassName:"table-header",width:150,renderCell:t=>a.jsxs(x,{direction:"row",spacing:"1rem",alignItems:"center",children:[a.jsx(v,{alt:t.row.name,src:t.row.sender.avatar}),a.jsx("span",{children:t.row.sender.name})]})},{field:"chat",headerName:"Chat",headerClassName:"table-header",width:220},{field:"groupChat",headerName:"Group Chat",headerClassName:"table-header",width:100},{field:"createdAt",headerName:"Time",headerClassName:"table-header",width:250}],O=()=>{const[t,s]=o.useState([]),[n,m]=o.useState(!0),[r,c]=o.useState(null),[l,p]=o.useState(null);return o.useEffect(()=>{(async()=>{try{const e=await N.get(`${C}/api/v1/admin/messages`,{withCredentials:!0});c(e.data)}catch(e){p(e)}finally{m(!1)}})()},[]),o.useEffect(()=>{var d;r&&s((d=r==null?void 0:r.messages)==null?void 0:d.map(e=>{var i,h;return{...e,id:e._id,sender:{name:(i=e==null?void 0:e.sender)==null?void 0:i.name,avatar:f((h=e==null?void 0:e.sender)==null?void 0:h.avatar,50)},createdAt:u(e.createdAt).format("MMMM Da YYYY,h:mm:ss a")}}))},[r]),M([{isError:l,error:l}]),a.jsx(j,{children:n?a.jsx(g,{height:"100vh"}):a.jsx(b,{heading:"All Messages",columns:E,rows:t,rowHeight:150})})};export{O as default};
