import{j as e,r as C,b as U,o as P,ah as q,_ as s,W as I,X as W,ai as L}from"./index-irexueTV.js";import{b as A,z as v,L as D}from"./index-DH6ci2QH.js";import{C as k}from"./Container-B0pkiVXL.js";import{P as B}from"./Modal-CTaQcr3u.js";import{c as F,T as n}from"./Typography-JwG0Pq1m.js";import{T as l}from"./TextField-BOKVHMeR.js";import{B as f}from"./Button-yxfB9dJ-.js";import{A as V}from"./Avatar-Cp4DZ0XV.js";import{I as E}from"./IconButton-DwQ1NlaF.js";import"./isMuiElement-Bv43l1N-.js";import"./Menu-Bt0IaSNa.js";const M=F([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),R=g=>{if(!A(g))return console.log(g.errorMessage),{isValid:!1,errorMessage:"username is invalid"}},Z=()=>{const[g,S]=C.useState(!0),[p,h]=C.useState(!1),y=()=>S(c=>!c),w=U(),j=v(""),b=v(""),r=v(""),a=v("",R),d=D(),T=async c=>{var x,m;c.preventDefault();const u=s.loading("Logging In...");h(!0);const t={withCredentials:!0,headers:{"content-type":"application/json"}};try{const{data:i}=await I.post(`${W}/api/v1/user/login`,{username:a.value,password:r.value},t);w(L(i.user)),s.success(i.message,{id:u})}catch(i){s.error(((m=(x=i.response)==null?void 0:x.data)==null?void 0:m.message)||"Invalid Username or Password",{id:u})}finally{h(!1)}},H=async c=>{var m,i;c.preventDefault();const u=s.loading("Signing Up...");h(!0);const t=new FormData;t.append("name",j.value),t.append("bio",b.value),t.append("username",a.value),t.append("password",r.value),t.append("avatar",d.file);const x={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}};try{const{data:o}=await I.post(`${W}/api/v1/user/new`,t,x);w(L(o.user)),s.success(o.message,{id:u}),console.log("handle Signup",o)}catch(o){s.error(((i=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:i.message)||"Something Went Wrong",{id:u})}finally{h(!1)}};return e.jsx("div",{style:{backgroundImage:"linear-gradient(rgb(44, 80 ,68 ,46%), rgb(112, 80, 9 ,18%))"},children:e.jsx(k,{component:"main",maxWidth:"xs",sx:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(B,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center"},children:g?e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"h5",children:"Login"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:T,children:[e.jsx(l,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:a.value,onChange:a.changeHandler}),a.error&&e.jsx(n,{color:"error",variant:"caption",children:a.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(n,{color:"error",variant:"caption",children:r.error}),e.jsx(f,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"contained",color:"primary",type:"submit",disabled:p,children:"Login"}),e.jsx(n,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(f,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"text",onClick:y,disabled:p,children:"Sign Up instead"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{variant:"h5",children:"Sign UP"}),e.jsxs("form",{style:{width:"100%",marginTop:"1rem"},onSubmit:H,children:[e.jsxs(P,{position:"relative",width:"10rem",margin:"auto",children:[e.jsx(V,{sx:{width:"10rem",height:"10rem",objectFit:"contain"},src:d.preview}),e.jsxs(E,{sx:{position:"absolute",bottom:"0",right:"0",color:"white",bgcolor:"rgba(0,0,0,0.5)",":hover":{bgcolor:"rgba(0,0,0,0.7)"}},component:"label",children:[e.jsx(M,{}),e.jsx(q,{type:"file",onChange:d.changeHandler})]})]}),d.error&&e.jsx(n,{m:"1rem auto",width:"fit-content",display:"block",color:"error",variannt:"caption",children:d.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Name",margin:"normal",variant:"outlined",value:j.value,onChange:j.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Bio",margin:"normal",variant:"outlined",value:b.value,onChange:b.changeHandler}),e.jsx(l,{required:!0,fullWidth:!0,label:"Username",margin:"normal",variant:"outlined",value:a.value,onChange:a.changeHandler}),a.error&&e.jsx(n,{color:"error",variant:"caption",children:a.error}),e.jsx(l,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",variant:"outlined",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(n,{color:"error",variant:"caption",children:r.error}),e.jsx(f,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"contained",color:"primary",type:"submit",disabled:p,children:"Sign UP"}),e.jsx(n,{textAlign:"center",m:"1rem",children:"OR"}),e.jsx(f,{sx:{marginTop:"1rem"},fullWidth:!0,variant:"text",onClick:y,disabled:p,children:"Login"})]})]})})})})};export{Z as default};
